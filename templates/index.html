<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF转Word工具</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .drop-area {
            border: 2px dashed #4CAF50;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .drop-area.active {
            background-color: #E8F5E9;
            border-color: #2E7D32;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .progress-bar {
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-green-600">PDF转Word工具</h1>
            <nav>
                <ul class="flex space-x-6">
                    <li><a href="/" class="text-gray-600 hover:text-green-600 transition-colors">首页</a></li>
                    <li><a href="/history" class="text-gray-600 hover:text-green-600 transition-colors">转换历史</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6">
            <!-- 首次使用引导 -->
            {% if first_use == 'true' %}
            <div id="guide-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg p-6 max-w-lg w-full mx-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">欢迎使用PDF转Word工具</h2>
                    <p class="text-gray-600 mb-4">这个工具可以帮助您轻松将PDF文件转换为可编辑的Word文档。</p>
                    <ul class="list-disc list-inside text-gray-600 mb-6 space-y-2">
                        <li>支持单文件和批量转换（最多10个文件）</li>
                        <li>提供"精准模式"和"快速模式"两种转换选项</li>
                        <li>支持OCR文字识别（适用于扫描版PDF）</li>
                        <li>文件大小限制：100MB</li>
                    </ul>
                    <button id="close-guide" class="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors w-full">开始使用</button>
                </div>
            </div>
            {% endif %}

            <!-- 单文件转换 -->
            <section class="mb-10">
                <h2 class="text-xl font-bold text-gray-800 mb-4">单文件转换</h2>
                <form action="/convert" method="post" enctype="multipart/form-data" class="space-y-4">
                    <div id="drop-area" class="drop-area p-8 text-center">
                        <input type="file" id="file-input" name="file" accept=".pdf" class="hidden">
                        <label for="file-input" class="cursor-pointer block">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-green-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                            </svg>
                            <p class="text-gray-600 mb-2">拖放PDF文件到这里，或</p>
                            <span class="bg-green-600 text-white py-2 px-4 rounded-md inline-block hover:bg-green-700 transition-colors">选择文件</span>
                        </label>
                        <p class="text-sm text-gray-500 mt-4">支持的格式：PDF (最大100MB)</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-700 mb-2">转换模式</label>
                            <select name="mode" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="fast">快速模式 - 优先转换速度</option>
                                <option value="accurate">精准模式 - 保留全部格式</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-gray-700 mb-2">OCR文字识别</label>
                            <select name="use_ocr" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="false">关闭 - 适用于文本型PDF</option>
                                <option value="true">开启 - 适用于扫描版PDF</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-gray-700 mb-2">自定义文件名 (可选)</label>
                        <input type="text" name="custom_filename" placeholder="输入自定义文件名，不包含扩展名" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        <p class="text-sm text-gray-500 mt-1">留空将使用原文件名</p>
                    </div>

                    <button type="submit" class="bg-green-600 text-white py-3 px-6 rounded-md hover:bg-green-700 transition-colors w-full md:w-auto">开始转换</button>
                </form>
            </section>

            <!-- 批量转换 -->
            <section>
                <h2 class="text-xl font-bold text-gray-800 mb-4">批量转换</h2>
                <form action="/batch_convert" method="post" enctype="multipart/form-data" class="space-y-4">
                    <div id="batch-drop-area" class="drop-area p-8 text-center">
                        <input type="file" id="batch-file-input" name="files" accept=".pdf" multiple class="hidden">
                        <label for="batch-file-input" class="cursor-pointer block">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-green-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            <p class="text-gray-600 mb-2">拖放多个PDF文件到这里，或</p>
                            <span class="bg-green-600 text-white py-2 px-4 rounded-md inline-block hover:bg-green-700 transition-colors">选择文件</span>
                        </label>
                        <p class="text-sm text-gray-500 mt-4">支持的格式：PDF (最大100MB/个，最多10个文件)</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-700 mb-2">转换模式</label>
                            <select name="mode" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="fast">快速模式 - 优先转换速度</option>
                                <option value="accurate">精准模式 - 保留全部格式</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-gray-700 mb-2">OCR文字识别</label>
                            <select name="use_ocr" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="false">关闭 - 适用于文本型PDF</option>
                                <option value="true">开启 - 适用于扫描版PDF</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-gray-700 mb-2">自定义文件名前缀 (可选)</label>
                        <input type="text" name="custom_prefix" placeholder="输入自定义文件名前缀" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        <p class="text-sm text-gray-500 mt-1">留空将使用原文件名，批量转换时会在文件名后添加序号</p>
                    </div>

                    <button type="submit" class="bg-green-600 text-white py-3 px-6 rounded-md hover:bg-green-700 transition-colors w-full md:w-auto">批量转换</button>
                </form>
            </section>
        </div>
    </main>

    <footer class="bg-white shadow-inner py-6">
        <div class="container mx-auto px-4 text-center text-gray-600">
            <p>&copy; 2025 PDF转Word工具 - 保留所有权利</p>
        </div>
    </footer>

    <script src="/static/js/main.js"></script>

        // 显示Flash消息
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="fixed bottom-4 right-4 bg-red-500 text-white px-4 py-2 rounded-md shadow-lg z-50 flash-message">
                    {{ messages[0] }}
                </div>
            {% endif %}
        {% endwith %}
</body>
</html>